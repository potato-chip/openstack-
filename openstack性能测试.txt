iperf命令是一个网络性能测试工具。iperf可以测试TCP和UDP带宽质量。iperf可以测量最大TCP带宽，具有多种参数和UDP特性。
iperf可以报告带宽，延迟抖动和数据包丢失。利用iperf这一特性，可以用来测试一些网络设备如路由器，防火墙，交换机等的性能。
iperf分为两种版本，Unix/Linux版和Windows版，Unix/Linux版更新比较快，版本最新。Windows版更新慢

客户端与服务器共用选项
-m, --print_mss 输出TCP MSS值（通过TCP_MAXSEG支持）。MSS值一般比MTU值小40字节。通常情况
-u, --udp 使用UDP方式而不是TCP方式。参看-b选项
-M, --mss #[KM} 通过TCP_MAXSEG选项尝试设置TCP最大信息段的值。MSS值的大小通常是TCP/ip头减去40字节。
================
在以太网中，MSS值 为1460字节（MTU1500字节）
MTU: Maxitum Transmission Unit 最大传输单元
MSS: Maxitum Segment Size 最大分段大小
MTU最大传输单元，这个最大传输单元实际上和链路层协议有着密切的关系，EthernetII帧的结构DMAC+SMAC+Type+Data+CRC
由于以太网传输电气方面的限制，每个以太网帧都有最小的大小64bytes最大不能超过1518bytes，
对于小于或者大于这个限制的以太网帧我们都可以视之为错误的数据帧，一般的以太网转发设备会丢弃这些数据帧。
由于以太网EthernetII最大的数据帧是1518Bytes这样，
刨去以太网帧的帧头（DMAC目的MAC地址 48bit=6Bytes+SMAC源MAC地址48bit=6Bytes+Type域2bytes）14Bytes
和帧尾CRC校验部分 4Bytes（这个部分有时候也把它叫做FCS），那么剩下承载上层协议的地方也就是Data域最大就只能有1500Bytes，
这个值我们就把它称之为MTU。这个就是网络层协议非常关心的地方，因为网络层协议比如IP协议会根据这个值来决定是否把上层传下来的数据进行分片
当两台远程PC互联的时候，它们的数据需要穿过很多的路由器和各种各样的网络媒介才能到达对端，网络中不同媒介的MTU各不相同。我们可以看下面的简单的组网图
PC1(192.168.0.1)DDDRouterDDDDInternetDDD－www server(238.136.1.1)
建立tcp连接的两端在三次握手时会协商tcp mss大小，具体如下：
pc1 发出syn报文，其中option选项填充的mss字段一般为1460，同样www server收到syn报文后，会发送syn＋ack报文应答，
option选项填充的mss字段也为1460；协商双方会比较syn和syn+ack报文中mss字段大小，选择较小的mss作为发送tcp分片的大小。
通过比较，协商双方的tcp mss都是1460
对于网络层的上层协议而言（我们以TCP/IP协议族为例）网络层IP协议会检查每个从上层协议下来的数据包的大小，
并根据本机MTU的大小决定是否作“分片”处理。分片最大的坏处就是降低了传输性能，
本来一次可以搞定的事情，分成多次搞定，所以在网络层更高一层（就是传输层）的实现中往往会对此加以注意！
所以会在IP数据包包头里面加上一个标签：DF（Donot Fragment）。这样当这个IP数据包通过多个路由其进行网络传输的时候，
如果遇到MTU小于IP数据包的情况，转发设备就会根据要求丢弃这个数据包。然后返回一个错误信息给发送者。
这样往往会造成某些通讯上的问题，不过幸运的是大部分网络链路都是MTU1500或者大于1500

MTU：maximum transmission unit，最大传输单元，由硬件规定，如以太网的MTU为1500字节。
MSS：maximum segment size，最大分节大小，为TCP数据包每次传输的最大数据分段大小，
一般由发送端向对端TCP通知对端在每个分节中能发送的最大TCP数据。MSS值为MTU值减去IPv4 Header（20 Byte）和TCP header（20 Byte）得到。
分片：若一IP数据报大小超过相应链路的MTU的时候，IPV4和IPV6都执行分片(fragmentation)，
各片段到达目的地前通常不会被重组(re-assembling)。IPV4主机对其产生的数据报执行分片，IPV4路由器对其转发的数据也执行分片。
然而IPV6只在数据产生的主机执行分片；IPV6路由器对其转发的数据不执行分片
====================
-c, --client host 运行Iperf的客户端模式，连接到指定的Iperf服务器端。
-w, --window #[KM] 设置套接字缓冲区为指定大小。对于TCP方式，此设置为TCP窗口大小。对于UDP方式，此设置为接受UDP数据包的缓冲区大小，
限制可以接受数据包的最大值。
-i, --interval # 设置每次报告之间的时间间隔，单位为秒。如果设置为非零值，就会按照此时间间隔输出测试报告。默认值为零。
-M, --mss #[KM} 通过TCP_MAXSEG选项尝试设置TCP最大信息段的值。MSS值的大小通常是TCP/ip头减去40字节。在以太网中，MSS值 为1460字节（MTU1500字节）。许多操作系统不支持此选项
-P, --parallel # 线程数。指定客户端与服务端之间使用的线程数。默认是1线程。需要客户端与服务器端同时使用此参数。
-t, --time # 设置传输的总时间。Iperf在指定的时间内，重复的发送指定长度的数据包。默认是10秒钟。参考-l与-n选项。










 

